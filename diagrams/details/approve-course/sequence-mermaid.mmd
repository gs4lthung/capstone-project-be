sequenceDiagram
    actor admin as Admin
    participant client as Client
    participant controller as Controller
    participant service as Service
    participant db as Database

    admin->>client: 1. View pending course requests
    client->>controller: 2. GET /courses/requests?filter=PENDING
    activate controller

    controller->>service: 3. findCourseRequests(filter)
    activate service

    service->>db: 4. Query pending requests
    activate db
    db-->>service: Pending courses list
    deactivate db

    service-->>controller: Response
    deactivate service

    controller-->>client: 5. HTTP 200
    deactivate controller

    client-->>admin: 6. Display pending courses

    admin->>client: 7. Click course to view details
    client->>controller: 8. GET /courses/requests/:id
    activate controller

    controller->>service: 9. getCourseRequestDetails(id)
    activate service

    service->>db: 10. Get course + lessons + sessions
    activate db
    db-->>service: Course data
    deactivate db

    service-->>controller: Response
    deactivate service

    controller-->>client: 11. HTTP 200
    deactivate controller

    client-->>admin: 12. Show course details

    admin->>client: 13. Approve course request
    client->>controller: 14. PATCH /courses/requests/:id/approve
    activate controller

    controller->>service: 15. approveCourseCreationRequest(id)
    activate service

    service->>db: 16. Find request + validate
    activate db
    db-->>service: Request data
    deactivate db

    service->>db: 17. Update course status = APPROVED
    activate db
    db-->>service: Updated
    deactivate db

    service->>db: 18. Generate sessions from schedules
    activate db
    db-->>service: Sessions created
    deactivate db

    service->>db: 19. Record approval action
    activate db
    db-->>service: Action saved
    deactivate db

    service->>db: 20. Send notification to coach
    
    service-->>controller: Success
    deactivate service

    controller-->>client: 21. HTTP 200
    deactivate controller

    client-->>admin: 22. Course approved
