@startuml ViewCourseCoachSequence

actor "Coach" as coach
participant "CourseController" as controller
participant "AuthGuard" as authGuard
participant "CourseService" as service
database "DataSource" as db

== View Coach's Courses ==

coach -> controller: GET /courses/coach?page=1&size=10
activate controller

controller -> authGuard: canActivate(context)
activate authGuard
authGuard --> controller: true (authenticated)
deactivate authGuard

controller -> service: findCoachCourses(page, size)
activate service

service -> db: transaction
activate db

db -> db: SELECT courses\nWHERE createdBy = :userId\nwith schedules, court

db --> service: PaginateObject<Course>
deactivate db

service --> controller: PaginateObject<Course>
deactivate service

controller --> coach: HTTP 200 PaginateObject<Course>
deactivate controller

== View Single Course Details ==

coach -> controller: GET /courses/:id
activate controller

controller -> service: findOne(id)
activate service

service -> db: transaction
activate db

db -> db: SELECT course with relations\n(sessions, createdBy, quiz, video,\nenrollments, user, subject,\nschedules, court, province, district)

db --> service: Course with full relations
deactivate db

service --> controller: Course
deactivate service

controller --> coach: HTTP 200 Course
deactivate controller

@enduml
